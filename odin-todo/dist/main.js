(()=>{"use strict";let t=new class{selectedProjectId="";selectedTaskId="";constructor(){this.projects=new class{projectId=1;taskId=1;constructor(){this.projects=[]}addProject(t){if(this.projects.find((e=>t===e.title)))return;let e=new class{constructor(t,e){this.title=t,this.id=e,this.tasks=[]}addTask(t){this.tasks.push(t)}removeTask(t){this.tasks=this.tasks.filter((e=>e.title!==t.title))}}(t,this.projectId);return this.projects.push(e),this.projectId++,e}removeProject(t){this.projects=this.projects.filter((e=>e.title!==t))}editProject(t,e){return!this.projects.find((t=>e===t.title))&&(this.projects=this.projects.map((s=>(s.title===t&&(s.title=e),s))),!0)}addTaskToProject(t,e,s){let o;return this.projects=this.projects.map((n=>(n.title===t&&(o=new class{constructor(t,e,s){this.title=t,this.description=e,this.id=s,this.completed=!1}}(e,s,this.taskId),this.taskId++,n.addTask(o)),n))),o}getTaskCountForProject(t){return this.projects.find((e=>t===e.title)).tasks.length}removeTaskForProjectById(t,e){this.projects=this.projects.map((s=>(s.title===t&&(s.tasks=s.tasks.filter((t=>t.id!==e))),s)))}editTaskForProjectById(t,e,s,o){let n,d=this.projects.find((e=>t===e.title));return d.tasks=d.tasks.map((t=>(t.id===e&&(t.title=s,t.description=o,n=t),t))),n}getTaskForProjectById(t,e){return this.projects.find((e=>t===e.title)).tasks.filter((t=>t.id===e))[0]}changeCompletionStateForTaskById(t,e,s){let o=this.projects.find((e=>t===e.title));o.tasks=o.tasks.map((t=>(t.id===e&&(t.completed=s),t)))}getTasksForProject(t){return this.projects.find((e=>t===e.title)).tasks}get projectsCount(){return this.projects.length}}}initDom(){this.addDefaultProjects(),this.initButtons(),this.openProject(document.getElementById("1-Test1"))}initButtons(){let t=document.getElementById("add-project-button"),e=document.getElementById("add-task-button"),s=document.getElementById("dialog"),o=document.getElementsByClassName("close")[0],n=document.querySelector(".dialog-close"),d=document.getElementById("project-form"),i=document.getElementById("dialog-input-project-name"),a=document.getElementById("dialog-input-task-name"),c=document.getElementById("dialog-input-description");d.addEventListener("submit",(()=>{if(d.classList.contains("add-project")){if(""===i.value)return;const t=i.value,e=this.projects.addProject(t);if(void 0===e.id)return;this.addProject(e)}else if(d.classList.contains("edit-project")){const t=this.getCurrentSelectedProjectDomElement(),e=t.querySelector(".user-project-title").textContent,s=i.value;if(!this.projects.editProject(e,s))return;this.editProject(s,t)}else if(d.classList.contains("remove-project")){const t=this.getCurrentSelectedProjectDomElement(),e=t.textContent;this.projects.removeProject(e),this.removeProject(t),this.resetContent()}else if(d.classList.contains("add-task")){if(""===a.value)return;const t=this.getCurrentSelectedProjectName(),e=a.value,s=c.value,o=this.projects.addTaskToProject(t,e,s);this.addTask(o)}else if(d.classList.contains("edit-task")){const t=this.getCurrentSelectedTaskDomElement(),e=this.getCurrentSelectedTaskId(),s=this.getCurrentSelectedTaskProjectName(),o=a.value,n=c.value,d=this.projects.editTaskForProjectById(s,e,o,n);this.editTask(d,t)}else if(d.classList.contains("remove-task")){const t=this.getCurrentSelectedTaskDomElement(),e=this.getCurrentSelectedTaskId(),s=this.getCurrentSelectedTaskProjectName();this.projects.removeTaskForProjectById(s,e),this.removeTask(t)}})),t.addEventListener("click",(()=>{this.showDialog(t)})),e.addEventListener("click",(()=>{this.showDialog(e)})),o.addEventListener("click",(()=>s.close())),n.addEventListener("click",(()=>s.close())),window.addEventListener("click",(t=>{t.target==s&&s.close()}))}showDialog(t){let e=document.getElementById("dialog"),s=document.getElementById("dialog-input-project-name"),o=document.getElementById("dialog-input-task-name"),n=document.getElementById("dialog-input-description"),d=document.getElementById("project-form"),i=document.getElementById("dialog-header-title"),a=document.getElementById("dialog-submit"),c=document.querySelector(".dialog-description"),r=document.querySelector(".dialog-add-project-content"),l=document.querySelector(".dialog-add-task-content");if(d.classList="",r.classList.add("hide"),l.classList.add("hide"),c.classList.add("hide"),t.classList.contains("add-project-button"))r.classList.remove("hide"),i.textContent="Add Project",a.textContent="Add",d.classList.add("add-project"),this.clearDialogInputField(),e.showModal();else if(t.classList.contains("edit-project-button")){r.classList.remove("hide"),i.textContent="Edit Project",a.textContent="Save",d.classList.add("edit-project");let o=t.parentNode.parentNode.textContent;s.value=o,e.showModal()}else if(t.classList.contains("remove-project-button")){c.classList.remove("hide");let s=t.parentNode.parentNode.textContent;i.textContent="Remove Project",a.textContent="Remove",c.textContent=`You are about to remove the project ${s}!`,d.classList.add("remove-project"),e.showModal()}else if(t.classList.contains("add-task-button"))l.classList.remove("hide"),i.textContent="Add Task",a.textContent="Add",d.classList.add("add-task"),this.clearDialogInputField(),e.showModal();else if(t.classList.contains("edit-task-button")){l.classList.remove("hide"),i.textContent="Edit Task",a.textContent="Save",d.classList.add("edit-task");const t=this.getCurrentSelectedTaskId(),s=this.getCurrentSelectedProjectName(),c=this.projects.getTaskForProjectById(s,t);o.value=c.title,n.value=c.description,e.showModal()}else if(t.classList.contains("remove-task-button")){c.classList.remove("hide");let s=t.parentNode.parentNode.textContent;i.textContent="Remove Task",a.textContent="Remove",c.textContent=`You are about to remove the task ${s}!`,d.classList.add("remove-task"),e.showModal()}}clearDialogInputField(){document.getElementById("dialog-input-project-name").value="",document.getElementById("dialog-input-task-name").value="",document.getElementById("dialog-input-description").value=""}addDefaultProjects(){const t=this.projects.addProject("Test1");this.addProject(t);const e=this.projects.addProject("Test2");this.addProject(e);const s=this.projects.addProject("Test3");this.addProject(s)}addProject(t){const e=document.getElementById("sidebar-projects"),s=document.createElement("div"),o=`${t.id}-${t.title}`;s.classList.add("sidebar-entry-project","hover-element-fill"),s.setAttribute("id",o);const n=document.createElement("span");n.classList.add("user-project-title"),n.textContent=t.title,s.appendChild(n);const d=document.createElement("div");d.classList.add("right-aligned-buttonbar");const i=document.createElement("button");i.classList.add("edit-project-button","scale-hover"),i.type="button",d.appendChild(i);const a=document.createElement("button");a.classList.add("remove-project-button","scale-hover"),a.type="button",d.appendChild(a),s.appendChild(d),d.addEventListener("click",(t=>t.stopPropagation())),s.addEventListener("click",(t=>{this.openProject(t.target)})),i.addEventListener("click",(t=>{t.stopPropagation(),this.openProject(t.target.parentNode.parentNode),this.showDialog(t.target)})),a.addEventListener("click",(t=>{t.stopPropagation(),this.openProject(t.target.parentNode.parentNode),this.showDialog(t.target)})),n.addEventListener("click",(t=>{t.stopPropagation(),this.openProject(t.target.parentNode)})),e.appendChild(s),this.updateProjectsCounter()}updateProjectsCounter(){document.getElementById("projects-count").textContent=`Projects (${this.projects.projectsCount})`}updateTaskCounter(){const t=document.getElementById("tasks-count"),e=this.getCurrentSelectedProjectName();let s=this.projects.getTaskCountForProject(e);t.textContent=`Tasks (${s})`}openProject(t){this.selectedProjectId=t.id,document.querySelectorAll("#sidebar-projects > div").forEach((t=>t.classList.remove("sidebar-entry-active"))),document.getElementById("content-project-title").textContent=t.textContent,t.classList.contains("sidebar-entry-project")&&t.classList.add("sidebar-entry-active"),this.loadProjectContent(t)}editProject(t,e){e.querySelector(".user-project-title").textContent=t}removeProject(t){t.remove(),this.updateProjectsCounter()}addTask(t){let e=this.getCurrentSelectedProjectName(),s=document.getElementById("content-tasks"),o=`${t.id}-${e}-${t.title}`,n=document.createElement("div");n.classList.add("content-task"),n.setAttribute("id",o),t.completed?n.classList.add("task-done"):n.classList.remove("task-done");let d=document.createElement("div");d.classList.add("content-task-left");let i=document.createElement("input");i.type="checkbox",i.setAttribute("id","task-completion-checkbox"),i.classList.add("input-field"),i.name="task-completion",i.checked=t.completed;let a=document.createElement("p");a.classList.add("task-title"),a.textContent=t.title;let c=document.createElement("p");c.classList.add("task-description"),c.textContent=t.description,d.appendChild(i),d.appendChild(a),d.appendChild(c);let r=document.createElement("div");r.classList.add("content-task-right");let l=document.createElement("button");l.classList.add("edit-task-button","scale-hover");let m=document.createElement("button");m.classList.add("remove-task-button","scale-hover"),r.appendChild(l),r.appendChild(m),a.addEventListener("click",(t=>{t.stopPropagation(),this.selectedTaskId=o,this.changeTaskCompletionDivPressed(t.target.parentNode)})),c.addEventListener("click",(t=>{t.stopPropagation(),this.selectedTaskId=o,this.changeTaskCompletionDivPressed(t.target.parentNode)})),i.addEventListener("change",(t=>{t.stopPropagation(),this.selectedTaskId=o,this.changeTaskCompletion(t.target.checked)})),i.addEventListener("click",(t=>{t.stopPropagation()})),n.addEventListener("click",(t=>{this.selectedTaskId=o,this.changeTaskCompletionDivPressed(t.target)})),l.addEventListener("click",(t=>{t.stopPropagation(),this.selectedTaskId=o,this.showDialog(t.target)})),m.addEventListener("click",(t=>{t.stopPropagation(),this.selectedTaskId=o,this.showDialog(t.target)})),n.appendChild(d),n.appendChild(r),s.appendChild(n),this.updateTaskCounter()}changeTaskCompletionDivPressed(t){const e=t.querySelector("#task-completion-checkbox"),s=e.checked;e.checked=!s,this.changeTaskCompletion(e.checked)}changeTaskCompletion(t){let e=this.getCurrentSelectedTaskDomElement(),s=this.getCurrentSelectedTaskId(),o=this.getCurrentSelectedTaskProjectName();this.projects.changeCompletionStateForTaskById(o,s,t),t?e.classList.add("task-done"):e.classList.remove("task-done")}editTask(t,e){e.querySelector(".task-title").textContent=t.title,e.querySelector(".task-description").textContent=t.description}removeTask(t){t.remove(),this.updateTaskCounter()}loadProjectContent(t){this.clearTasks();let e=t.textContent;this.projects.getTasksForProject(e).forEach((t=>{this.addTask(t)}))}clearTasks(){document.getElementById("content-tasks").innerHTML="",document.getElementById("tasks-count").textContent="Tasks (0)"}resetContent(){document.getElementById("content-project-title").textContent="Nothing selected :(",document.getElementById("content-tasks").innerHTML="",document.getElementById("tasks-count").textContent="Tasks (0)"}getCurrentSelectedProjectName(){return document.getElementById(this.selectedProjectId).textContent}getCurrentSelectedProjectDomElement(){return document.getElementById(this.selectedProjectId)}getCurrentSelectedTaskDomElement(){return document.getElementById(this.selectedTaskId)}getCurrentSelectedTaskId(){const t=this.getCurrentSelectedTaskDomElement().id.split("-");return Number(t[0])}getCurrentSelectedTaskProjectName(){return this.getCurrentSelectedTaskDomElement().id.split("-")[1]}};document.addEventListener("DOMContentLoaded",(()=>t.initDom()))})();