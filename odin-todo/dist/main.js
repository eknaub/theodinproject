(()=>{"use strict";let t=new class{selectedProjectId="";selectedTaskId="";constructor(){this.projects=new class{projectId=1;taskId=1;constructor(){this.projects=[]}addProject(t){if(this.projects.find((e=>t===e.title)))return;let e=new class{constructor(t,e){this.title=t,this.id=e,this.tasks=[]}addTask(t){this.tasks.push(t)}removeTask(t){this.tasks=this.tasks.filter((e=>e.title!==t.title))}}(t,this.projectId);return this.projects.push(e),this.projectId++,e}removeProject(t){this.projects=this.projects.filter((e=>e.title!==t))}editProject(t,e){return!this.projects.find((t=>e===t.title))&&(this.projects=this.projects.map((s=>(s.title===t&&(s.title=e),s))),!0)}addTaskToProject(t,e,s,o){let d;return this.projects=this.projects.map((n=>(n.title===t&&(d=new class{constructor(t,e,s,o){this.title=t,this.description=e,this.duedate=s,this.id=o,this.completed=!1}}(e,s,o,this.taskId),this.taskId++,n.addTask(d)),n))),d}getTaskCountForProject(t){return this.projects.find((e=>t===e.title)).tasks.length}removeTaskForProjectById(t,e){this.projects=this.projects.map((s=>(s.title===t&&(s.tasks=s.tasks.filter((t=>t.id!==e))),s)))}editTaskForProjectById(t,e,s,o,d){let n,i=this.projects.find((e=>t===e.title));return i.tasks=i.tasks.map((t=>(t.id===e&&(t.title=s,t.description=o,t.dueDate=d,n=t),t))),n}getTaskForProjectById(t,e){return this.projects.find((e=>t===e.title)).tasks.filter((t=>t.id===e))[0]}getTasksForProject(t){return this.projects.find((e=>t===e.title)).tasks}get projectsCount(){return this.projects.length}}}initDom(){this.addDefaultProjects(),this.loadProjects(),this.initButtons(),this.openProject(document.getElementById("1-Test1"))}initButtons(){let t=document.getElementById("add-project-button"),e=document.getElementById("add-task-button"),s=document.getElementById("dialog"),o=document.getElementsByClassName("close")[0],d=document.querySelector(".dialog-close"),n=document.getElementById("project-form"),i=document.getElementById("dialog-input-project-name"),a=document.getElementById("dialog-input-task-name"),c=document.getElementById("dialog-input-description"),r=document.getElementById("dialog-input-duedate"),l=document.getElementById("all"),u=document.getElementById("today"),p=document.getElementById("week");n.addEventListener("submit",(()=>{if(n.classList.contains("add-project")){if(""===i.value)return;const t=i.value,e=this.projects.addProject(t);if(void 0===e.id)return;this.addProject(e)}else if(n.classList.contains("edit-project")){const t=document.getElementById(this.selectedProjectId),e=t.querySelector(".user-project-title").textContent,s=i.value;if(!this.projects.editProject(e,s))return;this.editProject(s,t)}else if(n.classList.contains("remove-project")){const t=document.getElementById(this.selectedProjectId),e=t.textContent;this.projects.removeProject(e),this.removeProject(t),this.openProject(document.getElementById("all"))}else if(n.classList.contains("add-task")){if(""===a.value)return;const t=document.getElementById(this.selectedProjectId).textContent,e=a.value,s=c.value,o=r.value,d=this.projects.addTaskToProject(t,e,s,o);this.addTask(d)}else if(n.classList.contains("edit-task")){const t=document.getElementById(this.selectedTaskId),e=t.id.split("-"),s=Number(e[0]),o=e[1],d=a.value,n=c.value,i=r.value,l=this.projects.editTaskForProjectById(o,s,d,n,i);this.editTask(l,t)}else if(n.classList.contains("remove-task")){const t=document.getElementById(this.selectedTaskId),e=t.id.split("-"),s=Number(e[0]),o=e[1];this.projects.removeTaskForProjectById(o,s),this.removeTask(t)}})),t.addEventListener("click",(()=>{this.showDialog(t)})),e.addEventListener("click",(()=>{this.showDialog(e)})),o.addEventListener("click",(()=>s.close())),d.addEventListener("click",(()=>s.close())),l.addEventListener("click",(t=>this.openProject(t.target))),u.addEventListener("click",(t=>this.openProject(t.target))),p.addEventListener("click",(t=>this.openProject(t.target))),window.addEventListener("click",(t=>{t.target==s&&s.close()}))}showDialog(t){let e=document.getElementById("dialog"),s=document.getElementById("dialog-input-project-name"),o=document.getElementById("dialog-input-task-name"),d=document.getElementById("dialog-input-description"),n=document.getElementById("dialog-input-duedate"),i=document.getElementById("project-form"),a=document.getElementById("dialog-header-title"),c=document.getElementById("dialog-submit"),r=document.querySelector(".dialog-description"),l=document.querySelector(".dialog-add-project-content"),u=document.querySelector(".dialog-add-task-content");if(i.classList="",l.classList.add("hide"),u.classList.add("hide"),r.classList.add("hide"),t.classList.contains("add-project-button"))l.classList.remove("hide"),a.textContent="Add Project",c.textContent="Add",i.classList.add("add-project"),this.clearDialogInputField(),e.showModal();else if(t.classList.contains("edit-project-button")){l.classList.remove("hide"),a.textContent="Edit Project",c.textContent="Save",i.classList.add("edit-project");let o=t.parentNode.parentNode.textContent;s.value=o,e.showModal()}else if(t.classList.contains("remove-project-button")){r.classList.remove("hide");let s=t.parentNode.parentNode.textContent;a.textContent="Remove Project",c.textContent="Remove",r.textContent=`You are about to remove the project ${s}!`,i.classList.add("remove-project"),e.showModal()}else if(t.classList.contains("add-task-button"))u.classList.remove("hide"),a.textContent="Add Task",c.textContent="Add",i.classList.add("add-task"),this.clearDialogInputField(),e.showModal();else if(t.classList.contains("edit-task-button")){u.classList.remove("hide"),a.textContent="Edit Task",c.textContent="Save",i.classList.add("edit-task");const t=document.getElementById(this.selectedTaskId).id.split("-"),s=Number(t[0]),r=t[1],l=this.projects.getTaskForProjectById(r,s);o.value=l.title,d.value=l.description,n.value=l.dueDate,e.showModal()}else if(t.classList.contains("remove-task-button")){r.classList.remove("hide");let s=t.parentNode.parentNode.textContent;a.textContent="Remove Task",c.textContent="Remove",r.textContent=`You are about to remove the task ${s}!`,i.classList.add("remove-task"),e.showModal()}}clearDialogInputField(){document.getElementById("dialog-input-project-name").value="",document.getElementById("dialog-input-task-name").value="",document.getElementById("dialog-input-description").value="",document.getElementById("dialog-input-duedate").value=""}addDefaultProjects(){const t=this.projects.addProject("Test1");this.addProject(t);const e=this.projects.addProject("Test2");this.addProject(e);const s=this.projects.addProject("Test3");this.addProject(s)}addProject(t){const e=document.getElementById("sidebar-projects"),s=document.createElement("div"),o=`${t.id}-${t.title}`;s.classList.add("sidebar-entry-project","hover-element-fill"),s.setAttribute("id",o);const d=document.createElement("span");d.classList.add("user-project-title"),d.textContent=t.title,s.appendChild(d);const n=document.createElement("div");n.classList.add("right-aligned-buttonbar");const i=document.createElement("button");i.classList.add("edit-project-button","scale-hover"),i.type="button",n.appendChild(i);const a=document.createElement("button");a.classList.add("remove-project-button","scale-hover"),a.type="button",n.appendChild(a),s.appendChild(n),s.addEventListener("click",(t=>{this.openProject(t.target)})),i.addEventListener("click",(t=>{t.stopPropagation(),this.openProject(t.target.parentNode.parentNode),this.showDialog(t.target)})),a.addEventListener("click",(t=>{t.stopPropagation(),this.openProject(t.target.parentNode.parentNode),this.showDialog(t.target)})),d.addEventListener("click",(t=>{t.stopPropagation(),this.openProject(t.target.parentNode)})),e.appendChild(s),this.updateProjectsCounter()}updateProjectsCounter(){document.getElementById("projects-count").textContent=`Projects (${this.projects.projectsCount})`}updateTaskCounter(){const t=document.getElementById("tasks-count"),e=document.getElementById(this.selectedProjectId).textContent,s=this.projects.getTaskCountForProject(e);t.textContent=`Tasks (${s})`}openProject(t){this.selectedProjectId=t.id;const e=document.querySelectorAll("#sidebar-projects > div"),s=document.querySelectorAll("#default-projects > button");e.forEach((t=>t.classList.remove("sidebar-entry-active"))),s.forEach((t=>t.classList.remove("sidebar-entry-active"))),document.getElementById("content-project-title").textContent=t.textContent;const o=document.getElementById("add-task-button");"all"===this.selectedProjectId||"today"===this.selectedProjectId||"week"===this.selectedProjectId?o.classList.add("hide"):o.classList.remove("hide"),(t.classList.contains("sidebar-entry")||t.classList.contains("sidebar-entry-project"))&&t.classList.add("sidebar-entry-active"),this.loadProjectContent(t)}editProject(t,e){e.querySelector(".user-project-title").textContent=t}removeProject(t){t.remove(),this.updateProjectsCounter()}addTask(t){let e=document.getElementById(this.selectedProjectId).textContent,s=document.getElementById("content-tasks"),o=`${t.id}-${e}-${t.title}`,d=document.createElement("div");d.classList.add("content-task"),d.setAttribute("id",o);let n=document.createElement("div");n.classList.add("content-task-left");let i=document.createElement("input");i.type="checkbox",i.setAttribute("id","task-completion-checkbox"),i.classList.add("input-field"),i.name="task-completion",i.checked=t.completed;let a=document.createElement("p");a.classList.add("task-title"),a.textContent=t.title;let c=document.createElement("p");c.classList.add("task-description"),c.textContent=t.description,n.appendChild(i),n.appendChild(a),n.appendChild(c);let r=document.createElement("div");r.classList.add("content-task-right");let l=document.createElement("p");l.classList.add("task-duedate"),l.textContent=t.dueDate;let u=document.createElement("button");u.classList.add("edit-task-button","scale-hover");let p=document.createElement("button");p.classList.add("remove-task-button","scale-hover"),r.appendChild(l),r.appendChild(u),r.appendChild(p),i.addEventListener("change",(t=>{t.stopPropagation(),this.changeTaskCompletion(t.target.checked)})),i.addEventListener("click",(t=>{t.stopPropagation()})),d.addEventListener("click",(t=>{this.changeTaskCompletionDivPressed(t.target)})),u.addEventListener("click",(t=>{t.stopPropagation(),this.selectedTaskId=o,this.showDialog(t.target)})),p.addEventListener("click",(t=>{t.stopPropagation(),this.selectedTaskId=o,this.showDialog(t.target)})),d.appendChild(n),d.appendChild(r),s.appendChild(d),this.updateTaskCounter()}changeTaskCompletionDivPressed(t){const e=t.querySelector("#task-completion-checkbox"),s=e.checked;e.checked=!s,this.changeTaskCompletion(e.checked)}changeTaskCompletion(t){}editTask(t,e){e.querySelector(".task-title").textContent=t.title,e.querySelector(".task-description").textContent=t.description,e.querySelector(".task-duedate").textContent=t.dueDate}removeTask(t){t.remove(),this.updateTaskCounter()}loadProjectContent(t){if(this.clearTasks(),"all"===t.id)console.log("all");else if("today"===t.id)console.log("today");else if("week"===t.id)console.log("week");else{let e=t.textContent;this.projects.getTasksForProject(e).forEach((t=>{this.addTask(t)}))}}clearTasks(){document.getElementById("content-tasks").innerHTML="",document.getElementById("tasks-count").textContent="Tasks (0)"}loadProjects(){}};document.addEventListener("DOMContentLoaded",(()=>t.initDom()))})();